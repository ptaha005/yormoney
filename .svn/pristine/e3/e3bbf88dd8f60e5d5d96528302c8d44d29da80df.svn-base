define(["knockout","jquery","text!./../templates/AdressBook.html","core","vent","../../widgets/start"],function(e,t,n,r,i,s){var o=r.Model.extend({url:"/addressbook",fields:{id:{},name:{"default":"",validation:{required:!0}},phone:{"default":"",validation:{pattern:/^\d{1,9}$/}},email:{"default":"",validation:{required:!0,email:{message:"please use valid email address"}}},address:{"default":""},webaddress:{"default":"",validation:{pattern:/(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:/~\+#]*[\w\-\@?^=%&amp;/~\+#])?/}}},initialize:function(t){var n=[];t&&t.note&&(n=t.note),this.notes=e.observable(new s.Notes(n)),this.note=e.computed(function(){return this.notes().getNotes()},this)}});return function(){var t=this;t.letter=e.observable("A"),t.abc=e.observableArray(["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]),t.select=function(e){t.letter(e)},t.helpVideo=function(){i.trigger("showHowToVidio","income")},e.computed(function(){var n=t.letter();if(n=="new")return;r.ajax_post("/addressbook/list/"+n,{},function(n){var r=e.utils.arrayMap(n,function(e){return new o(e)});t.items(r)})}),t.add=function(){t.letter("new"),t.items([new o])},t.delete=function(e){r.ajax_post("/addressbook/delete",{id:e.id},function(n){t.items.remove(e)})},t.save=function(e){e.save(function(n){if(!n)return;e.id(n.id),t.letter(e.name()[0].toUpperCase())})},t.items=e.observableArray([]),t.template=n}})